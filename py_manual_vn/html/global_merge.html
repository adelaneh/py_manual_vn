<script type="text/javascript">
var getMergedClusters = function(e) {
	var mrgClstrs = new Object();
	for (var kk in merged_clusters) {
		mrgClstrs[kk] = [];
		for (var hhx = 0; hhx < merged_clusters[kk].length; hhx++) {
			hh = merged_clusters[kk][hhx];
			mrgClstrs[kk].push(hh);
		}
	}
	return mrgClstrs;
}

var mergedClusters = getMergedClusters();
</script>

<style>
.btn_clust_mrg {
	font-style: italic;
	border-radius: 0px;
}
.btn_clust_mrg.active {
	background-color: #3366CC;
}
.btn_clust_res {
	font-style: italic;
	border-radius: 0px;
}
.btn_clust_res.active {
	background-color: #728C00;
	color: white;
}
.btn_clust.active {
	background-color: gray;
	color: white;
}
.btn-primary {
	margin-right: 10px;
	margin-left: 10px;
}

.table-fixed thead {
	width: 100%;
}
.table-fixed tbody {
	height: 230px;
	overflow-y: auto;
	width: 100%;
}
.table-fixed thead, .table-fixed tbody, .table-fixed tr, .table-fixed td, .table-fixed th {
	display: block;
}
.table-fixed tbody td, .table-fixed thead > tr> th, .table-fixed thead > tr> td  {
	float: center;
	border-bottom-width: 0;
}
.table-fixed tbody > tr > td, .table-fixed thead > tr > td {
	width: 25%;
}
</style>
<script type="text/javascript">
$(function () {
	$('[data-toggle="popover"]').popover()
});
</script>
<div class="container" style="width: 90%;">
	<div class="panel panel-default">
		<div class="panel-heading">
			<h3>Global-merging of the Clusters</h3>
		</div>
		<div class="panel-body">
			<p></p>
			<!--			<div class="well"><h4>For each cluster on a column, check all the checkboxes next to clusters on rows which refer to the same entity and then click "Merge Selected Clusters". <p></p>Click "Finish Normalization" when you are done.</h4><p></p></div>-->
			<div class="well"><h4>
				<p>Global-merging proceeds in iterations. In each iteration, you
				<ul>
					<li>memorize the three target data values shown at the top of the three columns (see below).</li>
					<li>scan the values in the list below from top to bottom. If a value matches one of the target values, then check the appropriate box.</li>
					<li>click the "Merge Selected Values" button to merge the selected values and start a new iteration when reached the end of the list.</li>
				</ul>
				</p>
				<p>When there is no more iterations to work on, click the "Finish Normalization" button to finish the normalization process.</p>
<!--					<p>To do global merging, understand and memorize the three target clusters shown at the top of the three columns below. You can see all of the values in each target clusters by hovering your mouse over the corresponding label.</p>
					<p>Then scan the clusters in the list below top to bottom. If a cluster matches one of the target clusters, then check the appropriate box.</p>-->
				<p></p>
			</h4><p></p></div>

			<div id="selectsyn_box_top">
<!--				<button class="btn btn-primary" id="mrgbtntop" type="button" onclick="mergeClustersGlobally()">Merge Selected Clusters</button>
				<button class="btn btn-primary pull-right" id="donebtntop" type="button" onclick="norm_app.finish_global_merging(JSON.stringify(mergedClusters))">Finish Normalization</button>-->
			</div><p></p>
			<div id="cluster-panel" class="panel panel-primary">
				<div class="panel-body"id="clusters_labels_panel">
					<table style="width: 100%;">
						<thead><tr><td style="width: 90%;"><b><div id="iteration-cnt"></div><p></p><b>Remaining Values:</b><p></p></td>
								<!--<td style="width: 30%;"><b>Merged Clusters:</b><p></p></td></tr>-->
						</thead>
						<tbody>
						<tr><td id="pure_cell">
							<!--<table class="table" style="width: 100%;">
								<thead><tr>
										<td style="width: 25%;" align="center"><p></p></td>
										<td style="width: 25%;" align="center" data-container="body" data-toggle="popover" data-placement="left" data-html="true" data-trigger="hover" data-content="Label 1<br/>YES, Label 1"><b>Label 1</b><p></p></td>
										<td style="width: 25%;" align="center"><b>Label 2</b><p></p></td>
										<td style="width: 25%;" align="center"><b>Label 3</b><p></p></td>
										<td style="width: 30%;"><b>Merged Clusters:</b><p></p></td></tr>
								</thead>
								<tbody>
									<tr>
										<td style="width: 25%;">Label 1</td>
										<td style="width: 25%;" align="center"><input id="11" type="checkbox"></td>
										<td style="width: 25%;" align="center"><input id="12" type="checkbox"></td>
										<td style="width: 25%;" align="center"><input id="13" type="checkbox"></td>
									</tr>
									<tr>
										<td style="width: 25%;">Label 2</td>
										<td style="width: 25%;" align="center"><input id="21" type="checkbox"></td>
										<td style="width: 25%;" align="center"><input id="22" type="checkbox"></td>
										<td style="width: 25%;" align="center"><input id="23" type="checkbox"></td>
									</tr>
									<tr>
										<td style="width: 25%;">Label 3</td>
										<td style="width: 25%;" align="center"><input id="31" type="checkbox"></td>
										<td style="width: 25%;" align="center"><input id="32" type="checkbox"></td>
										<td style="width: 25%;" align="center"><input id="33" type="checkbox"></td>
									</tr>
									<tr>
										<td style="width: 25%;">Label 4</td>
										<td style="width: 25%;" align="center"><input id="41" type="checkbox"></td>
										<td style="width: 25%;" align="center"><input id="42" type="checkbox"></td>
										<td style="width: 25%;" align="center"><input id="43" type="checkbox"></td>
									</tr>
								</tbody>
							</table>-->
							<script type="text/javascript">
								loadGlobalMergeClusters();
							</script>
							</td>
							<!--<td id="results_cell">
								<script type="text/javascript">
									//loadMergedClustersInColumns();
								</script>
							</td>-->
						</tr>
						</tbody>
					</table>
				</div>
			</div>

			<div id="selectsyn_box">
				<button class="btn btn-primary" id="mrgbtnbtm" type="button" onclick="mergeClustersGlobally()">Merge Selected Values</button>
			</div>
			<p></p>
			<p></p>

			<div id="cluster-panel" class="panel panel-primary">
				<div class="panel-body" id="clusters_labels_panel" style="width: 100%;">
					<table>
						<tr>
							<td style="width: 80%;">
								<h4> When there is no more iterations to work on, click the "Finish Normalization" button to see the final normalization result.</h4>
							</td>
							<td style="width: 20%;" align="right">
								<button class="btn btn-warning pull-right" id="donebtnbtm" type="button" onclick="norm_app.finish_global_merging(JSON.stringify(mergedClusters))">Finish Normalization</button>
							</td>
						</tr>
					</table>
				</div>
			</div>
			<p></p>
		</div>
	</div>
</div>
